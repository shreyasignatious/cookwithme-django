{% extends 'base.html' %}

{% block title %}Update {{ data.reciepe_name }} - CookWithMe{% endblock %}

{% block content %}
<div class="card">
    <!-- Header -->
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h1><i class="fas fa-edit"></i> Update Recipe</h1>
        <div style="display: flex; gap: 1rem;">
            <a href="{% url 'view_one' data.reciepe_id %}" class="btn btn-outline">
                <i class="fas fa-eye"></i> View Recipe
            </a>
            <a href="{% url 'view_rec' %}" class="btn btn-outline">
                <i class="fas fa-arrow-left"></i> Back to Recipes
            </a>
        </div>
    </div>
    
    {% if error %}
        <div class="alert alert-error">
            <i class="fas fa-exclamation-circle"></i>
            {{ error }}
        </div>
    {% endif %}
    
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
            <!-- Left Column: Form -->
            <div>
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-pencil-alt"></i> Recipe Name</label>
                    <input type="text" name="reciepe_name" class="form-control" value="{{ data.reciepe_name }}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-file-alt"></i> Recipe Description</label>
                    <textarea name="reciepe_description" class="form-control" rows="8" required>{{ data.reciepe_description }}</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-star"></i> Rating</label>
                    <select name="rating" class="form-control" required>
                        {% for i in "12345" %}
                            <option value="{{ i }}" {% if data.rating|stringformat:"s" == i %}selected{% endif %}>
                                {{ i }} Star{% if i != "1" %}s{% endif %}
                            </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            
            <!-- Right Column: Image & Actions -->
            <div>
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-image"></i> Current Image</label>
                    <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; text-align: center;">
                        {% if data.image %}
                            <img src="{{ data.image.url }}" alt="{{ data.reciepe_name }}" 
                                 style="max-width: 100%; max-height: 250px; border-radius: 8px; margin-bottom: 1rem;">
                            <p style="color: #666; font-size: 0.9rem;">Current recipe image</p>
                        {% else %}
                            <div style="background: #e9ecef; height: 200px; display: flex; align-items: center; 
                                      justify-content: center; border-radius: 8px; margin-bottom: 1rem;">
                                <i class="fas fa-image" style="font-size: 3rem; color: #adb5bd;"></i>
                            </div>
                            <p style="color: #666; font-size: 0.9rem;">No image uploaded</p>
                        {% endif %}
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-upload"></i> Update Image</label>
                    <input type="file" name="reciepe_image" class="form-control" accept=".png,.jpg,.jpeg">
                    <small style="color: #666;">Leave empty to keep current image</small>
                </div>
                
                <!-- Delete Button -->
                <div style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid #f8f9fa;">
                    <h3 style="margin-bottom: 1rem; color: #e74c3c;"><i class="fas fa-exclamation-triangle"></i> Danger Zone</h3>
                    <p style="color: #666; margin-bottom: 1rem;">Once deleted, this recipe cannot be recovered.</p>
                    <a href="{% url 'delete_rec' data.reciepe_id %}" class="btn btn-danger" style="width: 100%;">
                        <i class="fas fa-trash"></i> Delete This Recipe
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Form Actions -->
        <div style="display: flex; gap: 1rem; margin-top: 2rem; padding-top: 2rem; border-top: 2px solid #f8f9fa;">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> Update Recipe
            </button>
            <button type="reset" class="btn btn-outline">
                <i class="fas fa-undo"></i> Reset Changes
            </button>
            <a href="{% url 'view_one' data.reciepe_id %}" class="btn btn-outline">
                <i class="fas fa-times"></i> Cancel
            </a>
        </div>
    </form>
</div>

<!-- Tips Card -->
<div class="card" style="background: linear-gradient(135deg, #fff9e6 0%, #ffeaa7 100%); border-left: 4px solid #f39c12;">
    <h3 style="color: #d35400;"><i class="fas fa-lightbulb"></i> Update Tips</h3>
    <ul style="list-style: none; margin-top: 1rem;">
        <li style="margin-bottom: 0.5rem;"><i class="fas fa-check" style="color: #27ae60;"></i> Update ratings if you've improved the recipe</li>
        <li style="margin-bottom: 0.5rem;"><i class="fas fa-check" style="color: #27ae60;"></i> Add new tips or variations you've discovered</li>
        <li><i class="fas fa-check" style="color: #27ae60;"></i> Consider updating photos for better presentation</li>
    </ul>
</div>
{% endblock %}